"0","ridge.reg <- function(x, y, th, x.pred = NULL) {"
"0","# estimation of beta in y = a + x beta + epsilon (linear regression)"
"0","# using ridge regression"
"0","# th is the penalization parameter in Lagrangian form"
"0","# use th = 0 for full regression"
"0","# note the intercept is added"
"0","# x.pred is a new x for which we wish to make prediction"
"0","d <- dim(x)"
"0","new.x <- matrix(c(rep(1, d[1]), x), d[1], d[2]+1) ## Adding intercept term"
"0","gram = t(new.x) %*% new.x"
"0","beta <- solve(gram + th*diag(d[2]+1)) %*% t(new.x) %*% matrix(y, d[1], 1)"
"0","condnum = max(svd(gram + th*diag(d[2]+1))$d)/min(svd(gram + th*diag(d[2]+1))$d)"
"0","pr <- 0"
"0","if (!is.null(x.pred)) pr <- sum(beta * c(1, x.pred))"
"0","list(beta = beta, pr=pr, condnum = condnum)"
"0","}"
